<script>
// Для GitHub Pages - имя вашего репозитория
const REPO_NAME = 'WingWine'; // Замените на ваше имя репозитория
const IS_GITHUB_PAGES = window.location.hostname.includes('github.io');

// Создаем базовый путь
let basePath = '';
if (IS_GITHUB_PAGES) {
    const pathSegments = window.location.pathname.split('/');
    if (pathSegments.length > 2) {
        basePath = '/' + pathSegments[1]; // Берем имя репозитория
    }
}

console.log('Base path:', basePath || '(корень)');

// Загружаем unmined.js
const script = document.createElement('script');
script.src = basePath ? `${basePath}/unmined.js` : 'unmined.js';

script.onload = function() {
    console.log('✅ Unmined загружен, создаем карту...');
    
    try {
        // Создаем карту
        const map = window.unmined.createMap('map', {
            baseUrl: basePath || '.',
            mapId: 'world',
            imageFormat: 'png',
            background: '#1a1a2e',
            sea: true,
            center: [0, 0],
            zoom: 1
        });
        
        // Скрываем индикатор загрузки
        setTimeout(() => {
            document.getElementById('loading').style.display = 'none';
        }, 1000);
        
    } catch (error) {
        console.error('Ошибка создания карты:', error);
        document.getElementById('loadingText').innerHTML = `
            <div style="color: #ff6b6b; text-align: center;">
                <h3>❌ Ошибка создания карты</h3>
                <p>${error.message}</p>
                <p>Проверьте:</p>
                <ol style="text-align: left; display: inline-block;">
                    <li>Сгенерированы ли тайлы карты?</li>
                    <li>Находится ли папка tiles в правильном месте?</li>
                    <li>Правильно ли указано имя репозитория?</li>
                </ol>
            </div>
        `;
    }
};

script.onerror = function() {
    console.error('Не удалось загрузить unmined.js');
    document.getElementById('loadingText').innerHTML = `
        <div style="color: #ff9800; text-align: center;">
            <h3>⚠️ Файл unmined.js не найден</h3>
            <p>Убедитесь, что файл unmined.js находится в корне репозитория</p>
            <p>Текущий путь: ${script.src}</p>
        </div>
    `;
};

document.head.appendChild(script);
</script>
