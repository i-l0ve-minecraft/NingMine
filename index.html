<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Карта Minecraft мира | Сид: 5215507659080688903 | Версия 1.21.10</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Подключаем стили Unmined -->
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
            background: rgba(15, 32, 39, 0.95);
            border-radius: 15px;
            border: 3px solid #00bcd4;
            box-shadow: 0 5px 20px rgba(0, 188, 212, 0.3);
            position: relative;
            z-index: 1000;
        }
        
        h1 {
            color: #00bcd4;
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
        }
        
        .server-info {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        
        .info-badge {
            background: rgba(0, 0, 0, 0.4);
            padding: 8px 16px;
            border-radius: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .seed-badge {
            color: #4caf50;
            border: 1px solid #4caf50;
        }
        
        .version-badge {
            color: #ff9800;
            border: 1px solid #ff9800;
        }
        
        .map-container {
            background: rgba(15, 32, 39, 0.9);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
            border: 3px solid #00bcd4;
            margin-bottom: 20px;
            height: 75vh;
            min-height: 600px;
            position: relative;
        }
        
        #map {
            height: 100%;
            width: 100%;
        }
        
        .controls-panel {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .control-btn {
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00bcd4;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            background: rgba(0, 188, 212, 0.3);
            transform: scale(1.1);
        }
        
        .coordinates-panel {
            position: absolute;
            bottom: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.8);
            color: #4caf50;
            padding: 10px 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            z-index: 1000;
            border: 1px solid #00bcd4;
            min-width: 180px;
        }
        
        .points-sidebar {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(15, 32, 39, 0.95);
            border-radius: 10px;
            padding: 15px;
            width: 300px;
            max-height: 70vh;
            overflow-y: auto;
            z-index: 1000;
            border: 2px solid #00bcd4;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .points-sidebar h3 {
            color: #00bcd4;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #00bcd4;
        }
        
        .point-item {
            background: rgba(0, 0, 0, 0.4);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid #4caf50;
        }
        
        .point-item:hover {
            background: rgba(0, 188, 212, 0.2);
            transform: translateX(5px);
        }
        
        .point-item h4 {
            color: #81d4fa;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .point-coords {
            font-family: 'Courier New', monospace;
            color: #69f0ae;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #81d4fa;
            font-size: 0.9rem;
            margin-top: 20px;
        }
        
        /* Стили для полосы прокрутки */
        .points-sidebar::-webkit-scrollbar {
            width: 8px;
        }
        
        .points-sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }
        
        .points-sidebar::-webkit-scrollbar-thumb {
            background: #00bcd4;
            border-radius: 4px;
        }
        
        /* Адаптивность */
        @media (max-width: 768px) {
            .points-sidebar {
                width: 250px;
                max-height: 50vh;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .map-container {
                height: 60vh;
            }
        }
        
        @media (max-width: 576px) {
            .points-sidebar {
                position: relative;
                width: 100%;
                max-height: 200px;
                margin-bottom: 15px;
                top: 0;
                left: 0;
            }
            
            .map-container {
                height: 50vh;
            }
            
            .controls-panel {
                top: 10px;
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-cube"></i> Карта Minecraft сервера</h1>
            <div class="server-info">
                <div class="info-badge seed-badge">
                    <i class="fas fa-seedling"></i> Сид: 5215507659080688903
                </div>
                <div class="info-badge version-badge">
                    <i class="fas fa-code-branch"></i> Версия: 1.21.10
                </div>
            </div>
        </header>
        
        <div class="points-sidebar">
            <h3><i class="fas fa-map-marker-alt"></i> Ключевые точки</h3>
            <div class="point-item" data-coords="0,0">
                <h4><i class="fas fa-flag"></i> Спавн</h4>
                <p>Главная точка появления</p>
                <div class="point-coords">X: 0, Z: 0</div>
            </div>
            <div class="point-item" data-coords="150,-120">
                <h4><i class="fas fa-home"></i> Деревня</h4>
                <p>Большая деревня у озера</p>
                <div class="point-coords">X: 150, Z: -120</div>
            </div>
            <div class="point-item" data-coords="-85,200">
                <h4><i class="fas fa-dungeon"></i> Подземелье</h4>
                <p>Заброшенная шахта</p>
                <div class="point-coords">X: -85, Z: 200</div>
            </div>
            <div class="point-item" data-coords="300,180">
                <h4><i class="fas fa-fire"></i> Портал в Ад</h4>
                <p>Ведет в крепость</p>
                <div class="point-coords">X: 300, Z: 180</div>
            </div>
            <div class="point-item" data-coords="450,-350">
                <h4><i class="fas fa-water"></i> Океанский памятник</h4>
                <p>Осторожно, стражи!</p>
                <div class="point-coords">X: 450, Z: -350</div>
            </div>
        </div>
        
        <div class="map-container">
            <div id="map"></div>
            
            <div class="controls-panel">
                <button class="control-btn" id="zoomIn" title="Приблизить">
                    <i class="fas fa-search-plus"></i>
                </button>
                <button class="control-btn" id="zoomOut" title="Отдалить">
                    <i class="fas fa-search-minus"></i>
                </button>
                <button class="control-btn" id="resetView" title="Центрировать">
                    <i class="fas fa-home"></i>
                </button>
                <button class="control-btn" id="fullscreenBtn" title="Полный экран">
                    <i class="fas fa-expand"></i>
                </button>
            </div>
            
            <div class="coordinates-panel" id="coordsDisplay">
                <div>X: <span id="coordX">0</span></div>
                <div>Z: <span id="coordZ">0</span></div>
                <div>Биом: <span id="biomeName">-</span></div>
            </div>
        </div>
        
        <footer>
            <p>Карта сгенерирована с помощью Unmined | Сид мира: 5215507659080688903 | Minecraft 1.21.10</p>
            <p>Используйте колесико мыши для управления. Кликните на точку в списке для перехода.</p>
        </footer>
    </div>

    <!-- ПОДКЛЮЧАЕМ ФАЙЛЫ Unmined -->
    <!-- ОЧЕНЬ ВАЖНО: unmined.js должен загружаться ПОСЛЕ Leaflet -->
    <script>
        // Сначала определяем глобальные переменные, которые нужны Unmined
        window.unmined = {
            map: null,
            options: {}
        };
    </script>
    
    <!-- Подключаем unmined.js - это ОСНОВНОЙ файл карты -->
    <script src="unmined.js"></script>
    
    <!-- Подключаем дополнительные файлы Unmined (если они есть) -->
    <script>
        // Проверяем наличие дополнительных файлов и подключаем их
        const unminedFiles = [
            'unmined.map.properties.js',
            'unmined.map.regions.js',
            'unmined.map.players.js',
            'custom.markers.js'
        ];
        
        unminedFiles.forEach(file => {
            const script = document.createElement('script');
            script.src = file;
            script.onerror = () => console.log(`Файл ${file} не найден, пропускаем...`);
            document.head.appendChild(script);
        });
    </script>
    
    <!-- Наш основной JavaScript код -->
    <script>
        // Ждем загрузки всех скриптов
        document.addEventListener('DOMContentLoaded', function() {
            // Даем время на загрузку unmined.js
            setTimeout(initMap, 500);
        });
        
        function initMap() {
            console.log('Инициализация карты Minecraft...');
            
            // Проверяем, загрузился ли unmined
            if (typeof window.unmined === 'undefined' || typeof window.unmined.createMap === 'undefined') {
                console.error('Unmined не загрузился! Проверьте путь к unmined.js');
                showError('Не удалось загрузить карту. Проверьте наличие файла unmined.js');
                return;
            }
            
            try {
                // Создаем карту с помощью Unmined
                // unmined.js автоматически найдет все необходимые файлы в той же папке
                const map = window.unmined.createMap('map', {
                    // Настройки карты
                    mapId: 'world', // ID мира (обычно 'world')
                    imageFormat: 'png', // Формат тайлов
                    markers: [], // Начальные маркеры (пустой массив)
                    markerIconFile: 'custom.pin.png', // Иконка маркера
                    
                    // Настройки отображения
                    background: '#0f2027',
                    sea: true,
                    transparent: false,
                    smoothLoading: true,
                    
                    // Координаты спавна (центр карты)
                    spawn: [0, 0],
                    
                    // Границы мира (примерные)
                    bounds: [[-5000, -5000], [5000, 5000]]
                });
                
                window.minecraftMap = map;
                
                // Обновление координат при движении мыши
                map.on('mousemove', function(e) {
                    const coords = e.latlng;
                    document.getElementById('coordX').textContent = Math.round(coords.lng);
                    document.getElementById('coordZ').textContent = Math.round(coords.lat);
                    
                    // Можно добавить определение биома если unmined поддерживает
                    updateBiome(coords.lat, coords.lng);
                });
                
                // Добавляем маркеры для ключевых точек
                addMarkersToMap(map);
                
                // Инициализация управления
                initControls(map);
                
                console.log('Карта успешно инициализирована!');
                
            } catch (error) {
                console.error('Ошибка при создании карты:', error);
                showError('Ошибка загрузки карты: ' + error.message);
            }
        }
        
        function addMarkersToMap(map) {
            // Точки для мира с сидом 5215507659080688903
            const minecraftPoints = [
                {
                    name: "Спавн",
                    description: "Главная точка появления в мире",
                    coords: [0, 0],
                    type: "spawn",
                    iconColor: "#00FF00",
                    icon: "flag"
                },
                {
                    name: "Деревня у озера",
                    description: "Большая деревня с библиотекой и кузницей",
                    coords: [150, -120],
                    type: "village",
                    iconColor: "#FFA500",
                    icon: "home"
                },
                {
                    name: "Заброшенная шахта",
                    description: "Шахта с спаунерами и сундуками",
                    coords: [-85, 200],
                    type: "dungeon",
                    iconColor: "#8B4513",
                    icon: "dungeon"
                },
                {
                    name: "Портал в Нижний мир",
                    description: "Ведет прямо в крепость",
                    coords: [300, 180],
                    type: "portal",
                    iconColor: "#FF0000",
                    icon: "fire"
                },
                {
                    name: "Океанский памятник",
                    description: "Глубоко в океане. Осторожно!",
                    coords: [450, -350],
                    type: "monument",
                    iconColor: "#0000FF",
                    icon: "water"
                },
                {
                    name: "Особняк в лесу",
                    description: "Особняк иллагеров в темном лесу",
                    coords: [-250, -400],
                    type: "mansion",
                    iconColor: "#800080",
                    icon: "landmark"
                },
                {
                    name: "Крепость",
                    description: "С порталом в Энд",
                    coords: [-180, 350],
                    type: "fortress",
                    iconColor: "#FF4500",
                    icon: "fortress"
                },
                {
                    name: "Древний город",
                    description: "В биоме Deep Dark",
                    coords: [220, 450],
                    type: "city",
                    iconColor: "#2F4F4F",
                    icon: "city"
                }
            ];
            
            // Используем маркеры Unmined если они доступны
            if (window.unmined && window.unmined.Marker) {
                minecraftPoints.forEach(point => {
                    const marker = new window.unmined.Marker({
                        x: point.coords[0],
                        z: point.coords[1],
                        icon: point.icon,
                        title: point.name,
                        description: point.description,
                        color: point.iconColor
                    });
                    
                    if (map.addMarker) {
                        map.addMarker(marker);
                    }
                });
            } else {
                // Альтернатива: используем Leaflet маркеры
                minecraftPoints.forEach(point => {
                    const marker = L.marker([point.coords[1], point.coords[0]], {
                        title: point.name
                    }).addTo(map);
                    
                    marker.bindPopup(`
                        <div style="min-width: 200px;">
                            <h3 style="color: ${point.iconColor}; margin: 0 0 10px 0;">
                                <i class="fas fa-${point.icon}"></i> ${point.name}
                            </h3>
                            <p style="margin: 0 0 10px 0;">${point.description}</p>
                            <div style="background: rgba(0,0,0,0.1); padding: 5px; border-radius: 3px; font-family: monospace;">
                                X: ${point.coords[0]}, Z: ${point.coords[1]}
                            </div>
                        </div>
                    `);
                });
            }
        }
        
        function updateBiome(z, x) {
            // Заглушка для определения биома
            // В реальном проекте можно использовать API unmined для определения биома
            const biomes = [
                "Равнина", "Лес", "Горы", "Пустыня", 
                "Джунгли", "Тайга", "Океан", "Болото"
            ];
            
            const hash = Math.abs(Math.sin(z * 12.9898 + x * 78.233) * 43758.5453);
            const biomeIndex = Math.floor(hash % biomes.length);
            
            document.getElementById('biomeName').textContent = biomes[biomeIndex];
        }
        
        function initControls(map) {
            // Кнопки управления
            document.getElementById('zoomIn').addEventListener('click', function() {
                map.zoomIn();
            });
            
            document.getElementById('zoomOut').addEventListener('click', function() {
                map.zoomOut();
            });
            
            document.getElementById('resetView').addEventListener('click', function() {
                map.setView([0, 0], 0);
            });
            
            document.getElementById('fullscreenBtn').addEventListener('click', function() {
                const mapContainer = document.querySelector('.map-container');
                if (!document.fullscreenElement) {
                    mapContainer.requestFullscreen?.() || 
                    mapContainer.webkitRequestFullscreen?.() || 
                    mapContainer.msRequestFullscreen?.();
                } else {
                    document.exitFullscreen?.() || 
                    document.webkitExitFullscreen?.() || 
                    document.msExitFullscreen?.();
                }
            });
            
            // Клики по точкам в сайдбаре
            document.querySelectorAll('.point-item').forEach(item => {
                item.addEventListener('click', function() {
                    const coords = this.getAttribute('data-coords').split(',');
                    const x = parseInt(coords[0]);
                    const z = parseInt(coords[1]);
                    
                    // Перемещаем карту к точке
                    map.setView([z, x], 3);
                    
                    // Ищем и открываем маркер
                    map.eachLayer(layer => {
                        if (layer instanceof L.Marker) {
                            const markerPos = layer.getLatLng();
                            if (Math.round(markerPos.lng) === x && Math.round(markerPos.lat) === z) {
                                layer.openPopup();
                            }
                        }
                    });
                });
            });
            
            // Смена иконки при полном экране
            document.addEventListener('fullscreenchange', function() {
                const fullscreenBtn = document.getElementById('fullscreenBtn');
                if (document.fullscreenElement) {
                    fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                    fullscreenBtn.title = 'Выйти из полного экрана';
                } else {
                    fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                    fullscreenBtn.title = 'Полный экран';
                }
            });
        }
        
        function showError(message) {
            const mapContainer = document.getElementById('map');
            mapContainer.innerHTML = `
                <div style="
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    text-align: center;
                    color: #ff6b6b;
                    background: rgba(0,0,0,0.8);
                    padding: 30px;
                    border-radius: 10px;
                    border: 2px solid #ff6b6b;
                ">
                    <h3><i class="fas fa-exclamation-triangle"></i> Ошибка загрузки карты</h3>
                    <p>${message}</p>
                    <p style="margin-top: 20px; font-size: 0.9rem;">
                        Убедитесь, что все файлы Unmined находятся в той же папке, что и index.html
                    </p>
                </div>
            `;
        }
    </script>
</body>
</html>
